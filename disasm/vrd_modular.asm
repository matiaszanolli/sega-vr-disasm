; ============================================================================
; Virtua Racing Deluxe (USA) - Sega 32X
; Modular Assembly File - REFACTORED VERSION
; ============================================================================
;
; Product: V.R.DX
; Serial: GM MK-84601-00
; Copyright: (C)SEGA 1994.SEP
; ROM Size: 3MB (3,145,728 bytes)
;
; Build: make modular
; Verify: make compare-modular (should show PERFECT MATCH)
;
; MODULE ORGANIZATION:
;   All code is now organized in modules/ directory by feature:
;   - boot/: ROM header, init sequence
;   - main-loop/: V-INT handler, state machine
;   - input/: Controller handling
;   - display/: VDP operations
;   - sound/: Z80 sound interface
;   - hardware-regs/: MARS register access
;   - game/: Game logic
;   - data/: Data sections and SH2 code
;
; ============================================================================

        include "sections/mars_defs.asm"

; ============================================================================
; Modular sections (all code organized by feature)
; ============================================================================

; --- Boot ---
        include "modules/68k/boot/rom_header.asm"
        include "modules/68k/boot/init_sequence.asm"

; --- Main Loop ---
        include "modules/68k/main-loop/vint_handler.asm"

; --- Input ---
        include "modules/68k/input/controller_read.asm"
        include "modules/68k/input/input_processing.asm"

; --- Display ---
        include "modules/68k/display/vdp_operations.asm"

; --- Input ---
        include "modules/68k/input/button_handling.asm"
        include "modules/68k/input/state_machine.asm"

; --- Game Logic ---
        include "modules/68k/game/game_logic_1.asm"
        include "modules/68k/game/game_logic_2.asm"

; --- Hardware ---
        include "modules/68k/hardware-regs/hw_reg_init.asm"

; --- Game Logic ---
        include "modules/68k/game/game_logic_3.asm"
        include "modules/68k/game/game_logic_4.asm"

; --- Sound ---
        include "modules/68k/sound/z80_commands.asm"

; --- Game Logic ---
        include "modules/68k/game/game_0e200.asm"
        include "modules/68k/game/game_10200.asm"
        include "modules/68k/game/game_12200.asm"
        include "modules/68k/game/game_14200.asm"
        include "modules/68k/game/game_16200.asm"

; --- Data/SH2 ---
        include "modules/68k/data/section_18200.asm"
        include "modules/68k/data/section_1a200.asm"
        include "modules/68k/data/section_1c200.asm"
        include "modules/68k/data/section_1e200.asm"
        include "modules/68k/data/section_20200.asm"
        include "modules/68k/data/section_22200.asm"

; --- SH2 Code ---
        include "modules/68k/sh2/section_24200.asm"
        include "modules/68k/sh2/section_26200.asm"

; --- Data/SH2 ---
        include "modules/68k/data/section_28200.asm"
        include "modules/68k/data/section_2a200.asm"
        include "modules/68k/data/section_2c200.asm"
        include "modules/68k/data/section_2e200.asm"
        include "modules/68k/data/section_30200.asm"
        include "modules/68k/data/section_32200.asm"
        include "modules/68k/data/section_34200.asm"
        include "modules/68k/data/section_36200.asm"
        include "modules/68k/data/section_38200.asm"
        include "modules/68k/data/section_3a200.asm"
        include "modules/68k/data/section_3c200.asm"
        include "modules/68k/data/section_3e200.asm"
        include "modules/68k/data/section_40200.asm"
        include "modules/68k/data/section_42200.asm"
        include "modules/68k/data/section_44200.asm"
        include "modules/68k/data/section_46200.asm"
        include "modules/68k/data/section_48200.asm"
        include "modules/68k/data/section_4a200.asm"
        include "modules/68k/data/section_4c200.asm"
        include "modules/68k/data/section_4e200.asm"
        include "modules/68k/data/section_50200.asm"
        include "modules/68k/data/section_52200.asm"
        include "modules/68k/data/section_54200.asm"
        include "modules/68k/data/section_56200.asm"
        include "modules/68k/data/section_58200.asm"
        include "modules/68k/data/section_5a200.asm"
        include "modules/68k/data/section_5c200.asm"
        include "modules/68k/data/section_5e200.asm"
        include "modules/68k/data/section_60200.asm"
        include "modules/68k/data/section_62200.asm"
        include "modules/68k/data/section_64200.asm"
        include "modules/68k/data/section_66200.asm"
        include "modules/68k/data/section_68200.asm"
        include "modules/68k/data/section_6a200.asm"
        include "modules/68k/data/section_6c200.asm"
        include "modules/68k/data/section_6e200.asm"
        include "modules/68k/data/section_70200.asm"
        include "modules/68k/data/section_72200.asm"
        include "modules/68k/data/section_74200.asm"
        include "modules/68k/data/section_76200.asm"
        include "modules/68k/data/section_78200.asm"
        include "modules/68k/data/section_7a200.asm"
        include "modules/68k/data/section_7c200.asm"
        include "modules/68k/data/section_7e200.asm"
        include "modules/68k/data/section_80200.asm"
        include "modules/68k/data/section_82200.asm"
        include "modules/68k/data/section_84200.asm"
        include "modules/68k/data/section_86200.asm"
        include "modules/68k/data/section_88200.asm"
        include "modules/68k/data/section_8a200.asm"
        include "modules/68k/data/section_8c200.asm"
        include "modules/68k/data/section_8e200.asm"
        include "modules/68k/data/section_90200.asm"
        include "modules/68k/data/section_92200.asm"
        include "modules/68k/data/section_94200.asm"
        include "modules/68k/data/section_96200.asm"
        include "modules/68k/data/section_98200.asm"
        include "modules/68k/data/section_9a200.asm"
        include "modules/68k/data/section_9c200.asm"
        include "modules/68k/data/section_9e200.asm"
        include "modules/68k/data/section_a0200.asm"
        include "modules/68k/data/section_a2200.asm"
        include "modules/68k/data/section_a4200.asm"
        include "modules/68k/data/section_a6200.asm"
        include "modules/68k/data/section_a8200.asm"
        include "modules/68k/data/section_aa200.asm"
        include "modules/68k/data/section_ac200.asm"
        include "modules/68k/data/section_ae200.asm"
        include "modules/68k/data/section_b0200.asm"
        include "modules/68k/data/section_b2200.asm"
        include "modules/68k/data/section_b4200.asm"
        include "modules/68k/data/section_b6200.asm"
        include "modules/68k/data/section_b8200.asm"
        include "modules/68k/data/section_ba200.asm"
        include "modules/68k/data/section_bc200.asm"
        include "modules/68k/data/section_be200.asm"
        include "modules/68k/data/section_c0200.asm"
        include "modules/68k/data/section_c2200.asm"
        include "modules/68k/data/section_c4200.asm"
        include "modules/68k/data/section_c6200.asm"
        include "modules/68k/data/section_c8200.asm"
        include "modules/68k/data/section_ca200.asm"
        include "modules/68k/data/section_cc200.asm"
        include "modules/68k/data/section_ce200.asm"
        include "modules/68k/data/section_d0200.asm"
        include "modules/68k/data/section_d2200.asm"
        include "modules/68k/data/section_d4200.asm"
        include "modules/68k/data/section_d6200.asm"
        include "modules/68k/data/section_d8200.asm"
        include "modules/68k/data/section_da200.asm"
        include "modules/68k/data/section_dc200.asm"
        include "modules/68k/data/section_de200.asm"
        include "modules/68k/data/section_e0200.asm"
        include "modules/68k/data/section_e2200.asm"
        include "modules/68k/data/section_e4200.asm"
        include "modules/68k/data/section_e6200.asm"
        include "modules/68k/data/section_e8200.asm"
        include "modules/68k/data/section_ea200.asm"
        include "modules/68k/data/section_ec200.asm"
        include "modules/68k/data/section_ee200.asm"
        include "modules/68k/data/section_f0200.asm"
        include "modules/68k/data/section_f2200.asm"
        include "modules/68k/data/section_f4200.asm"
        include "modules/68k/data/section_f6200.asm"
        include "modules/68k/data/section_f8200.asm"
        include "modules/68k/data/section_fa200.asm"
        include "modules/68k/data/section_fc200.asm"
        include "modules/68k/data/section_fe200.asm"
        include "modules/68k/data/section_100200.asm"
        include "modules/68k/data/section_102200.asm"
        include "modules/68k/data/section_104200.asm"
        include "modules/68k/data/section_106200.asm"
        include "modules/68k/data/section_108200.asm"
        include "modules/68k/data/section_10a200.asm"
        include "modules/68k/data/section_10c200.asm"
        include "modules/68k/data/section_10e200.asm"
        include "modules/68k/data/section_110200.asm"
        include "modules/68k/data/section_112200.asm"
        include "modules/68k/data/section_114200.asm"
        include "modules/68k/data/section_116200.asm"
        include "modules/68k/data/section_118200.asm"
        include "modules/68k/data/section_11a200.asm"
        include "modules/68k/data/section_11c200.asm"
        include "modules/68k/data/section_11e200.asm"
        include "modules/68k/data/section_120200.asm"
        include "modules/68k/data/section_122200.asm"
        include "modules/68k/data/section_124200.asm"
        include "modules/68k/data/section_126200.asm"
        include "modules/68k/data/section_128200.asm"
        include "modules/68k/data/section_12a200.asm"
        include "modules/68k/data/section_12c200.asm"
        include "modules/68k/data/section_12e200.asm"
        include "modules/68k/data/section_130200.asm"
        include "modules/68k/data/section_132200.asm"
        include "modules/68k/data/section_134200.asm"
        include "modules/68k/data/section_136200.asm"
        include "modules/68k/data/section_138200.asm"
        include "modules/68k/data/section_13a200.asm"
        include "modules/68k/data/section_13c200.asm"
        include "modules/68k/data/section_13e200.asm"
        include "modules/68k/data/section_140200.asm"
        include "modules/68k/data/section_142200.asm"
        include "modules/68k/data/section_144200.asm"
        include "modules/68k/data/section_146200.asm"
        include "modules/68k/data/section_148200.asm"
        include "modules/68k/data/section_14a200.asm"
        include "modules/68k/data/section_14c200.asm"
        include "modules/68k/data/section_14e200.asm"
        include "modules/68k/data/section_150200.asm"
        include "modules/68k/data/section_152200.asm"
        include "modules/68k/data/section_154200.asm"
        include "modules/68k/data/section_156200.asm"
        include "modules/68k/data/section_158200.asm"
        include "modules/68k/data/section_15a200.asm"
        include "modules/68k/data/section_15c200.asm"
        include "modules/68k/data/section_15e200.asm"
        include "modules/68k/data/section_160200.asm"
        include "modules/68k/data/section_162200.asm"
        include "modules/68k/data/section_164200.asm"
        include "modules/68k/data/section_166200.asm"
        include "modules/68k/data/section_168200.asm"
        include "modules/68k/data/section_16a200.asm"
        include "modules/68k/data/section_16c200.asm"
        include "modules/68k/data/section_16e200.asm"
        include "modules/68k/data/section_170200.asm"
        include "modules/68k/data/section_172200.asm"
        include "modules/68k/data/section_174200.asm"
        include "modules/68k/data/section_176200.asm"
        include "modules/68k/data/section_178200.asm"
        include "modules/68k/data/section_17a200.asm"
        include "modules/68k/data/section_17c200.asm"
        include "modules/68k/data/section_17e200.asm"
        include "modules/68k/data/section_180200.asm"
        include "modules/68k/data/section_182200.asm"
        include "modules/68k/data/section_184200.asm"
        include "modules/68k/data/section_186200.asm"
        include "modules/68k/data/section_188200.asm"
        include "modules/68k/data/section_18a200.asm"
        include "modules/68k/data/section_18c200.asm"
        include "modules/68k/data/section_18e200.asm"
        include "modules/68k/data/section_190200.asm"
        include "modules/68k/data/section_192200.asm"
        include "modules/68k/data/section_194200.asm"
        include "modules/68k/data/section_196200.asm"
        include "modules/68k/data/section_198200.asm"
        include "modules/68k/data/section_19a200.asm"
        include "modules/68k/data/section_19c200.asm"
        include "modules/68k/data/section_19e200.asm"
        include "modules/68k/data/section_1a0200.asm"
        include "modules/68k/data/section_1a2200.asm"
        include "modules/68k/data/section_1a4200.asm"
        include "modules/68k/data/section_1a6200.asm"
        include "modules/68k/data/section_1a8200.asm"
        include "modules/68k/data/section_1aa200.asm"
        include "modules/68k/data/section_1ac200.asm"
        include "modules/68k/data/section_1ae200.asm"
        include "modules/68k/data/section_1b0200.asm"
        include "modules/68k/data/section_1b2200.asm"
        include "modules/68k/data/section_1b4200.asm"
        include "modules/68k/data/section_1b6200.asm"
        include "modules/68k/data/section_1b8200.asm"
        include "modules/68k/data/section_1ba200.asm"
        include "modules/68k/data/section_1bc200.asm"
        include "modules/68k/data/section_1be200.asm"
        include "modules/68k/data/section_1c0200.asm"
        include "modules/68k/data/section_1c2200.asm"
        include "modules/68k/data/section_1c4200.asm"
        include "modules/68k/data/section_1c6200.asm"
        include "modules/68k/data/section_1c8200.asm"
        include "modules/68k/data/section_1ca200.asm"
        include "modules/68k/data/section_1cc200.asm"
        include "modules/68k/data/section_1ce200.asm"
        include "modules/68k/data/section_1d0200.asm"
        include "modules/68k/data/section_1d2200.asm"
        include "modules/68k/data/section_1d4200.asm"
        include "modules/68k/data/section_1d6200.asm"
        include "modules/68k/data/section_1d8200.asm"
        include "modules/68k/data/section_1da200.asm"
        include "modules/68k/data/section_1dc200.asm"
        include "modules/68k/data/section_1de200.asm"
        include "modules/68k/data/section_1e0200.asm"
        include "modules/68k/data/section_1e2200.asm"
        include "modules/68k/data/section_1e4200.asm"
        include "modules/68k/data/section_1e6200.asm"
        include "modules/68k/data/section_1e8200.asm"
        include "modules/68k/data/section_1ea200.asm"
        include "modules/68k/data/section_1ec200.asm"
        include "modules/68k/data/section_1ee200.asm"
        include "modules/68k/data/section_1f0200.asm"
        include "modules/68k/data/section_1f2200.asm"
        include "modules/68k/data/section_1f4200.asm"
        include "modules/68k/data/section_1f6200.asm"
        include "modules/68k/data/section_1f8200.asm"
        include "modules/68k/data/section_1fa200.asm"
        include "modules/68k/data/section_1fc200.asm"
        include "modules/68k/data/section_1fe200.asm"
        include "modules/68k/data/section_200200.asm"
        include "modules/68k/data/section_202200.asm"
        include "modules/68k/data/section_204200.asm"
        include "modules/68k/data/section_206200.asm"
        include "modules/68k/data/section_208200.asm"
        include "modules/68k/data/section_20a200.asm"
        include "modules/68k/data/section_20c200.asm"
        include "modules/68k/data/section_20e200.asm"
        include "modules/68k/data/section_210200.asm"
        include "modules/68k/data/section_212200.asm"
        include "modules/68k/data/section_214200.asm"
        include "modules/68k/data/section_216200.asm"
        include "modules/68k/data/section_218200.asm"
        include "modules/68k/data/section_21a200.asm"
        include "modules/68k/data/section_21c200.asm"
        include "modules/68k/data/section_21e200.asm"
        include "modules/68k/data/section_220200.asm"
        include "modules/68k/data/section_222200.asm"
        include "modules/68k/data/section_224200.asm"
        include "modules/68k/data/section_226200.asm"
        include "modules/68k/data/section_228200.asm"
        include "modules/68k/data/section_22a200.asm"
        include "modules/68k/data/section_22c200.asm"
        include "modules/68k/data/section_22e200.asm"
        include "modules/68k/data/section_230200.asm"
        include "modules/68k/data/section_232200.asm"
        include "modules/68k/data/section_234200.asm"
        include "modules/68k/data/section_236200.asm"
        include "modules/68k/data/section_238200.asm"
        include "modules/68k/data/section_23a200.asm"
        include "modules/68k/data/section_23c200.asm"
        include "modules/68k/data/section_23e200.asm"
        include "modules/68k/data/section_240200.asm"
        include "modules/68k/data/section_242200.asm"
        include "modules/68k/data/section_244200.asm"
        include "modules/68k/data/section_246200.asm"
        include "modules/68k/data/section_248200.asm"
        include "modules/68k/data/section_24a200.asm"
        include "modules/68k/data/section_24c200.asm"
        include "modules/68k/data/section_24e200.asm"
        include "modules/68k/data/section_250200.asm"
        include "modules/68k/data/section_252200.asm"
        include "modules/68k/data/section_254200.asm"
        include "modules/68k/data/section_256200.asm"
        include "modules/68k/data/section_258200.asm"
        include "modules/68k/data/section_25a200.asm"
        include "modules/68k/data/section_25c200.asm"
        include "modules/68k/data/section_25e200.asm"
        include "modules/68k/data/section_260200.asm"
        include "modules/68k/data/section_262200.asm"
        include "modules/68k/data/section_264200.asm"
        include "modules/68k/data/section_266200.asm"
        include "modules/68k/data/section_268200.asm"
        include "modules/68k/data/section_26a200.asm"
        include "modules/68k/data/section_26c200.asm"
        include "modules/68k/data/section_26e200.asm"
        include "modules/68k/data/section_270200.asm"
        include "modules/68k/data/section_272200.asm"
        include "modules/68k/data/section_274200.asm"
        include "modules/68k/data/section_276200.asm"
        include "modules/68k/data/section_278200.asm"
        include "modules/68k/data/section_27a200.asm"
        include "modules/68k/data/section_27c200.asm"
        include "modules/68k/data/section_27e200.asm"
        include "modules/68k/data/section_280200.asm"
        include "modules/68k/data/section_282200.asm"
        include "modules/68k/data/section_284200.asm"
        include "modules/68k/data/section_286200.asm"
        include "modules/68k/data/section_288200.asm"
        include "modules/68k/data/section_28a200.asm"
        include "modules/68k/data/section_28c200.asm"
        include "modules/68k/data/section_28e200.asm"
        include "modules/68k/data/section_290200.asm"
        include "modules/68k/data/section_292200.asm"
        include "modules/68k/data/section_294200.asm"
        include "modules/68k/data/section_296200.asm"
        include "modules/68k/data/section_298200.asm"
        include "modules/68k/data/section_29a200.asm"
        include "modules/68k/data/section_29c200.asm"
        include "modules/68k/data/section_29e200.asm"
        include "modules/68k/data/section_2a0200.asm"
        include "modules/68k/data/section_2a2200.asm"
        include "modules/68k/data/section_2a4200.asm"
        include "modules/68k/data/section_2a6200.asm"
        include "modules/68k/data/section_2a8200.asm"
        include "modules/68k/data/section_2aa200.asm"
        include "modules/68k/data/section_2ac200.asm"
        include "modules/68k/data/section_2ae200.asm"
        include "modules/68k/data/section_2b0200.asm"
        include "modules/68k/data/section_2b2200.asm"
        include "modules/68k/data/section_2b4200.asm"
        include "modules/68k/data/section_2b6200.asm"
        include "modules/68k/data/section_2b8200.asm"
        include "modules/68k/data/section_2ba200.asm"
        include "modules/68k/data/section_2bc200.asm"
        include "modules/68k/data/section_2be200.asm"
        include "modules/68k/data/section_2c0200.asm"
        include "modules/68k/data/section_2c2200.asm"
        include "modules/68k/data/section_2c4200.asm"
        include "modules/68k/data/section_2c6200.asm"
        include "modules/68k/data/section_2c8200.asm"
        include "modules/68k/data/section_2ca200.asm"
        include "modules/68k/data/section_2cc200.asm"
        include "modules/68k/data/section_2ce200.asm"
        include "modules/68k/data/section_2d0200.asm"
        include "modules/68k/data/section_2d2200.asm"
        include "modules/68k/data/section_2d4200.asm"
        include "modules/68k/data/section_2d6200.asm"
        include "modules/68k/data/section_2d8200.asm"
        include "modules/68k/data/section_2da200.asm"
        include "modules/68k/data/section_2dc200.asm"
        include "modules/68k/data/section_2de200.asm"
        include "modules/68k/data/section_2e0200.asm"
        include "modules/68k/data/section_2e2200.asm"
        include "modules/68k/data/section_2e4200.asm"
        include "modules/68k/data/section_2e6200.asm"
        include "modules/68k/data/section_2e8200.asm"
        include "modules/68k/data/section_2ea200.asm"
        include "modules/68k/data/section_2ec200.asm"
        include "modules/68k/data/section_2ee200.asm"
        include "modules/68k/data/section_2f0200.asm"
        include "modules/68k/data/section_2f2200.asm"
        include "modules/68k/data/section_2f4200.asm"
        include "modules/68k/data/section_2f6200.asm"
        include "modules/68k/data/section_2f8200.asm"
        include "modules/68k/data/section_2fa200.asm"
        include "modules/68k/data/section_2fc200.asm"
        include "modules/68k/data/section_2fe200.asm"
